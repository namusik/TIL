# Singleton Pattern

## 배경
소프트웨어 개발에서 특정 시나리오에서는 애플리케이션 수명 주기 전체에 걸쳐 클래스에 인스턴스가 하나만 있어야 함.

싱글톤 패턴은 클래스의 인스턴스화를 제어하고, 객체가 하나만 존재하도록 보장하며, 해당 인스턴스에 대한 전역 액세스 지점을 제공함으로써 이러한 요구 사항을 해결

## 특징
- instance
  - 인스턴스 요소
  - 객체가 만들어질 때 마다 함께 생성돼서 메모리를 차지
- static 
  - 정적 요소
  - 만들어지는 객체의 개수와 상관없이 하나만 존재

## 개념
- 단일 static 인스턴스: 해당 클래스의 유일한 인스턴스를 저장하는 필드. static 이기 때문에 인스턴스 개수에 관계없이 단일한 존재.
- 글로벌 액세스 포인트: 애플리케이션의 모든 부분에서 단일 인스턴스에 액세스할 수 있는 방법을 제공
- 액세스 제어: 인스턴스 생성 방법과 시기를 제어 가능
- 지연 초기화(선택 사항): 필요할 때만 인스턴스가 생성됨.

## 구조
- Private Constructor: 다른 클래스가 클래스를 직접 인스턴스화하는 것을 방지
- Static Private Instance: 클래스 자기 자신의 타입을 필드로 가지는 유일한 인스턴스
- Public Static Method: 싱글톤 인스턴스에 대한 전역 액세스 지점을 제공

## 스레드 안전한 싱글톤
- 멀티 스레드 환경에서는 적절한 동기화가 없으면 여러 스레드가 getInstance() 메서드에 동시에 액세스하여 여러 싱글톤 인스턴스가 생성될 수 있다.

## 직렬화 취약점
- 싱글톤 인스턴스를 직렬화 후, 역직렬화하여 다시 객체로 만들면 싱글톤의 제어된 인스턴스화를 우회하여 객체의 새 인스턴스를 생성해버림.
- readResolve() 메서드 구현: 이 메서드는 역직렬화 중에 새 싱글톤 인스턴스를 만드는 대신 기존 싱글톤 인스턴스가 반환되도록

## 리플렉션 취약점
- 리플렉션을 사용하면 Singleton의 비공개 생성자에 액세스하고 새 인스턴스를 만드는 것이 가능
- 싱글톤 생성자 수정: 리플렉션을 통해 두 번째 인스턴스를 생성하려고 하면 예외가 발생하도록

## Enum 싱글톤
- 직렬화를 자동으로 처리하여 역직렬화 중에 새 인스턴스가 생성되는 것을 방지
- 리플렉션을 통해 인스턴스화될 수 없도록 보장하여 본질적으로 리플렉션 공격으로부터 보호
- Enum 기반 싱글톤은 기본적으로 간결하고 스레드로부터 안전

## 스프링 싱글톤과의 차이
|측면 |	전통적인 싱글톤	|스프링 싱글톤|
|-------------|-------------|---------------|
|인스턴스 범위|	JVM별	|       Spring IoC 컨테이너별|
|구현 책임	  |개발자	        |스프링 프레임워크|
|글로벌 액세스|	예(getInstance()를 통해)	|종속성 주입을 통해 관리|
|스레드 안전성	|수동 구현 필요	|구성에 따라 Spring에서 처리됨|

## 출처
https://www.youtube.com/watch?v=1c_wLi0_B1A