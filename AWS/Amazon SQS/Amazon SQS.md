# Amazon SQS

## 정의
마이크로 서비스, 분산 시스템 및 서버리스 애플리케이션을 쉽게 분리하고 확장할 수 있도록 지원하는 완전관리형 메시지 대기열 서비스

## 개념
AWS에서 제공하는 큐 서비스 

* 다른 서비스에서 사용할 수 있도록 메시지를 잠시 저장하는 용도
* 최대 256kb, **최대 14일 저장 가능**
  * AWS SNS는 따로 메시지를 저장하지 않는다. 이게 큰 차이

디커플링 : 주로 AWS 서비스들의 **느슨한 연결**을 수립하려 사용

하나의 메시지를 한번만 처리
* 한 주체에서만 처리

AWS에서 제일 오래된 서비스

## 디커플링
![awssqs](../../images/AWS/awssqs.png)
1. 원본동영상 -> S3 -> Lambda -> EC2
2. 만약 갑자기 EC2가 다운되면, 거기서 끝나는 거임. 메시지 전달 실패에 대한 처리 매커니즘이 없다.

![awssqs2](../../images/AWS/awssqs2.png)
1. Lambda가 SQS에 메세지를 전달한다.
2. SQS는 메세지를 저장한다.
3. 그러면 EC2들이 SQS에서 메세지를 빼서 사용한다.
4. 이러면 EC2가 모두 다운되더라도, 메세지는 유실되지 않는다.
5. 또한 추후 아키텍처가 바뀌더라도, SQS 이전 부분은 바꾸지 않아도 된다.

## SNS 와의 차이
![snsvssqs](../../images/AWS/snsvssqs.png)

전달방식
SNS는 직접 서비스들에게 PUSH, 전달해준다.

SQS는 서비스에서 PULL, SQS에서 요청을 보내서 메세지를 가져간다.