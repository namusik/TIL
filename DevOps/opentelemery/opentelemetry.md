# Opentelemetry

## 개념

애플리케이션의 분산 추적(Distributed Tracing)과 메트릭 수집을 위한 오픈소스 프로젝트

마이크로서비스 환경에서 애플리케이션 성능을 모니터링하고 분석하는 데 유용

Spring Boot와 함께 사용하면 애플리케이션의 성능 데이터와 추적 정보를 쉽게 수집하고 시각화할 수 있어 애플리케이션 모니터링 및 디버깅에 많은 도움을 준다.

## OpenTelemetry의 주요 기능

1.	**분산 추적 (Distributed Tracing):** 
마이크로서비스와 같이 여러 서비스가 상호작용하는 환경에서 개별 서비스 요청의 경로와 각 서비스의 응답 시간을 추적할 수 있습니다. 이를 통해 전체 애플리케이션의 성능과 병목 지점을 파악하는 데 도움이 됩니다.

2.	**메트릭 (Metrics):** 
시스템의 상태를 나타내는 메트릭 데이터를 수집합니다. 예를 들어, 요청 지연 시간, CPU 사용률, 메모리 사용량 등을 측정하여 시스템의 상태와 성능을 실시간으로 모니터링할 수 있습니다.
3.	**로그 (Logs):** 
분산 환경에서 발생하는 로그를 수집하고 추적 데이터와 연결하여 이벤트 흐름을 더 쉽게 이해할 수 있습니다.

## Spring Boot와 OpenTelemetry 통합하기

Spring Boot 애플리케이션에 OpenTelemetry를 통합하는 방식은 주로 다음과 같습니다.
1.	의존성 추가: OpenTelemetry와 관련된 라이브러리를 Gradle이나 Maven에 추가합니다. 예를 들어 opentelemetry-java-instrumentation이나 opentelemetry-sdk 라이브러리를 사용하여 추적 기능을 적용할 수 있습니다.
2.	에이전트 설정: OpenTelemetry Java 에이전트를 설정하면 Spring Boot 애플리케이션 코드의 변경 없이도 자동으로 추적 데이터가 수집됩니다. 이는 JVM 옵션으로 에이전트를 설정하는 방식으로 구성할 수 있습니다.
3.	트레이서와 메트릭 수집기 설정: 애플리케이션에서 직접 OpenTelemetry 트레이서나 메트릭 수집기를 설정하여 중요한 비즈니스 로직이나 지표를 추적할 수 있습니다. 예를 들어 특정 메소드의 성능이나 서비스 간 호출 정보를 수집하도록 설정할 수 있습니다.
4.	수집된 데이터 시각화: 수집된 데이터를 외부 시스템(Grafana, Prometheus 등)과 연동해 모니터링 대시보드에서 시각화할 수 있습니다. 특히, Jaeger와 Zipkin은 분산 추적 데이터를 시각화하는 데 많이 사용됩니다.

## Spring Boot + OpenTelemetry로 얻을 수 있는 장점

-	문제 진단: 분산된 애플리케이션의 성능 저하 원인과 병목 지점을 쉽게 파악할 수 있습니다.
-	데이터 시각화: 애플리케이션의 요청 흐름, 지연 시간, 오류율 등을 시각화하여 더 직관적으로 파악할 수 있습니다.
-	자동화된 메트릭 수집: Spring Boot와 OpenTelemetry의 자동화 기능을 통해 애플리케이션의 메트릭과 추적 정보를 효율적으로 수집할 수 있습니다.